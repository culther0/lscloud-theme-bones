---
action: 'shop:order'
template: default
published: true
name: Order
url: '/order/:orderId'
---
<h1>{{ page.title }}</h1>
{% if order %}

  <p><strong>Order number: </strong> #{{ order.number }} </p>
  {% if order.invoices[0].payments().last().guessPaymentMethod() %}
  <p><strong>Payment method: </strong> {{ order.invoices[0].payments().last().guessPaymentMethod().name }}</p>
  {% endif %}
  <p><strong>Order Date: </strong> {{ order.created_at.format('M jS, Y') }}</p>

	<table class="product-list full-width">
	  <tr>
	    <th>Item</th>
	    <th class="narrow">Quantity</th>
	    <th class="narrow">Price</th>
	    <th class="narrow">Discount</th>
	    <th class="narrow">Total</th>
	  </tr>
	  {% for invoice in order.invoices %}
	    {% for shipment in invoice.shipments %}
	      {% for item in shipment.shipmentItems %}
	      <tr>
	        <td>
	          <a class="hide-for-small" href="/product/{{ item.product.url_name }}"><img src="{{ item.product.images.first.thumbnail(80, 80)|default('http://placehold.it/80x80') }}"/></a>
	          <div class="short-description">
	            <h3><a href="/product/{{ item.product.url_name }}">{{ item.product.name }}</a></h3>
	            
	            {% set description = item.optionsString() %}
	            {% if description %}<p>{{ description|unescape }}</p>{% endif %}
	          </div>
	        </td>
	        <td class="narrow"><h4>{{ item.quantity|number_format(0) }}</h4></td>
	        <td class="narrow"><h4>{{ item.pivot.price|currency }}</h4></td>
	        <td class="narrow"><h4>{{ 0|currency }}</h4></td>
	        <td class="narrow"><h4>{{ (item.quantity *item.pivot.price)|currency }}</h4></td>
	      </tr>
	      {% endfor %}
	    {% endfor %}
	  {% endfor %}
	</table>

  {% if order.payment_method.has_payment_form() and not order.payment_processed() %}
    <a class="button" href="{{ root_url('/review/'~order.order_hash) }}">Pay the order</a>
  {% endif %}

	{% if order.total_discount %}
	  <p><strong>Discount applied:</strong> <h4>{{ order.total_discount|currency }}</h4></p>
	{% endif %}
	<p><strong>Subtotal:</strong> <h4>{{ order.subtotal_invoiced|currency }}</h4></p>
	<p><strong>Sales Tax:</strong> <h4>{{ order.total_sales_tax|currency }}</h4></p>
	<p><strong>Shipping:</strong> <h4>{{ order.total_shipping_quote|currency }}</h4></p>
	{% if order.total_shipping_tax %}
	  <p><strong>Shipping Taxes:</strong> <h4>{{ order.total_shipping_tax|currency }}</h4></p>
	{% endif %}
	<p class="subtotal"><strong>Total:</strong>  <h4>{{ order.total|currency }}</h4></p>

{% else %}
  <p class="flash error">Order not found</p>
{% endif %}